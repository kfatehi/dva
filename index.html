<!DOCTYPE HTML>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8" />
  <title></title>
  <script src="//cdnjs.cloudflare.com/ajax/libs/bluebird/3.3.5/bluebird.js" type="text/javascript" charset="utf-8"></script>
</head>
<body>
<script type="text/javascript">


App = {
	loadData: function(dataSetId) {
    return new Promise(function(resolve, reject) {
      resolve([{
        source: 1,
        target: 2,
        flights: 5,
        complaints: 3 
      }])
    });
	},
  loadProps: function() {
    return new Promise(function(resolve, reject) {
      resolve({
        "labels": {
          "font": "12px sans-serif",
          "color": "black"
        }
      })
    });
  }
}

d3.select('g').style('font', config.props.labels.font);

getDefaultSchemaProperties = function(ext) {
  ext.loadSchema().then(function(schema){
  return  getDefaultSchemaProperties( schema.properties);
  })
}


    // generated data:
var bucketMapping = {
  from: ['source'],
  to: ['target'],
  value: ['flights', 'complaints']
};

var bucketMapping = {
  subgroup: ['Last Name'],
  group: ['Country', 'Quarter'],
  value: ['Sales']
}

var App.load('com.sankey').then(function(ext) {
  return [
    App.loadData(dataSetID),
    ext,
    App.loadSchema('com.sankey')
  ]
}).spread(function(data, ext, schema){
  
  var leanData = parseData(data, bucketMapping);

  [{
    subgroup: ['Smithh'],
    group: ['UK', 'Qtr3'],
    value: [16753]
  }]

  var config = {
    width: 500,
    height: 400,
    data: leanData,
    buckets: bucketMapping, // this here for labelling purposes
    props: mergeSchemaProperties(schema.properties, { /* user overrides */ })
  }
  ext.render(document.body, config);
});

// ---------- for the index.html extensions test...

  var config = {
    width: 500,
    height: 400,
    data: [{
      subgroup: ['Smithh'],
      group: ['UK', 'Qtr3'],
      value: [16753]
    }]
    buckets: bucketMapping,
    props: mergeSchemaProperties(schema.properties, { /* user overrides */ })
  }

</script>

test


</body>
</html>
